---
title: "Lab 7 Assignment: Group 09"
format:
  html:
    embed-resources: true
editor: visual
bibliography: references.bib
---

**Authors**:

-   Selina Friesen - s252027

-   Marta Sánchez - s254791

-   Sergi Fornós - s253693

-   Tommaso Ballocci - s257151

-   Ivan Musalyk - s225210

In the following assigment we will be working with the dataset from the dataset, which comes originally from the MASS package. It is a breast cancer dataset from the University of Wisconsin Hospitals, Madison from Dr.William H. Wolberg. He assessed biopsies of breast tumors for 699 patients; each of nine attributes was scored on a scale of 1 to 10. The true outcome (benign/malignant) is also known.

## Load the libraries

```{r}
#| warning: false
library(tidyverse)
library(broom)  
library(cowplot)

```

## Load the dataset

```{r}
biopsy <- read_csv("https://wilkelab.org/classes/SDS348/data_sets/biopsy.csv")
```

## Create a PCA

```{r}
pca_fit <- biopsy |>
  select(where(is.numeric)) |>
  prcomp(scale = TRUE)
```

## Look at the data in PC coordinates

```{r}
arrow_style <- arrow(
  angle = 20, ends = "first", type = "closed", length = grid::unit(8, "pt")
)

pca_fit |>
  tidy(matrix = "rotation") |>
  pivot_wider(names_from = "PC", names_prefix = "PC", values_from = "value") |>
  ggplot(aes(PC1, PC2)) +
  geom_segment(xend = 0, yend = 0, arrow = arrow_style) +
  geom_text(
    aes(label = column),
    hjust = 1, nudge_x = -0.1, 
    color = "#909"
  ) +
  xlim(-1.25, .5) + ylim(-.5, 1) +
  coord_fixed() +
  theme_minimal_grid(12)
```

To understand which variables are responsible for the PCs, we are visualizing the different PCs. Here, we can see how "mitoses" is the variable that mostly drives the PC2. Taken together, this shows that mitoses is the variable that mostly distinguishes benign and malignant biopsies in this dataset.

```{r}
pca_fit |>
  tidy(matrix = "rotation") |>
  pivot_wider(names_from = "PC", names_prefix = "PC", values_from = "value") |>
  ggplot(aes(PC1, PC3)) +
  geom_segment(xend = 0, yend = 0, arrow = arrow_style) +
  geom_text(
    aes(label = column),
    hjust = 1, nudge_x = -0.1, 
    color = "#8fbc8f"
  ) +
  xlim(-1.25, .5) + ylim(-.5, 1) +
  coord_fixed() +
  theme_minimal_grid(12)
```

In this case, PC3 is mostly driven by "clump_thickness". In relations to the previous analysis, this means that the clump thickness cannot help us distinguish benign from malignant biopsies.
